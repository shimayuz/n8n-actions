# Discord Chatbot 実装詳細仕様

## アーキテクチャ概要
- **方式**: ポーリング型（30秒間隔）
- **AI**: LangChain + OpenAI GPT-4o-mini
- **フロー**: 定期実行 → メッセージ取得 → 新規判定 → AI応答 → 返信

## エラーハンドリング
1. **Discord API エラー**
   - レート制限: 自動リトライ
   - 接続エラー: 次回実行で再試行

2. **OpenAI API エラー**
   - トークン上限: 短縮して再試行
   - API障害: エラーメッセージをログ

## パフォーマンス最適化
1. **メッセージ取得数**: 10件に制限
2. **AI応答**: 最大500トークン
3. **重複処理防止**: タイムスタンプフィルター

## セキュリティ考慮事項
1. **認証情報**: n8n Credentialsで安全に管理
2. **ボット権限**: 最小限の権限のみ付与
3. **メッセージフィルタ**: ボット自身のメッセージ除外

## 拡張可能性
1. **コマンド機能**: プレフィックス判定を追加可能
2. **マルチチャンネル**: 複数チャンネル対応可能
3. **カスタムAI**: プロンプトカスタマイズ可能

## デプロイ手順
1. Discord Bot作成とToken取得
2. n8nにCredentials設定
3. ワークフローインポート
4. チャンネルID設定
5. ワークフローを有効化

## 制限事項
- 30秒以内の連続メッセージは1回の処理でまとめて応答
- 編集されたメッセージは検知不可
- リアクション機能は未実装
EOF < /dev/null
